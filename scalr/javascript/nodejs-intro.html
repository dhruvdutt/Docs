<html><head><style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\:form{display:block;}</style>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width">

  <title>Appbase Documentation</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" type="text/css" href="../../bower_components/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="../../bower_components/bootstrap/dist/css/bootstrap-theme.min.css">

  <script async="" src="http://www.google-analytics.com/analytics.js"></script><script type="text/javascript" src="../../bower_components/docbase/scripts/polyfill.js"></script>
  <!-- Flatdoc -->
  <script type="text/javascript" src="../../bower_components/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript" src="../../bower_components/flatdoc/legacy.js"></script>
  <script type="text/javascript" src="../../bower_components/flatdoc/flatdoc.js"></script>

  <!-- Flatdoc theme -->
  <link rel="stylesheet" type="text/css" href="../../bower_components/flatdoc/theme-white/style.css">
  <script type="text/javascript" src="../../bower_components/docbase/scripts/flatdoc-theme.js"></script>

  <!-- DocBase -->
  <script type="text/javascript" src="../../bower_components/angular/angular.js"></script>
  <script type="text/javascript" src="../../bower_components/angular-route/angular-route.js"></script>
  <script type="text/javascript" src="../../bower_components/js-schema/js-schema.min.js"></script>

  <script type="text/javascript" src="../../bower_components/docbase/scripts/docbase.js"></script>
  <script src="../../bower_components/google-code-prettify/bin/prettify.min.js"></script>
  <link rel="stylesheet" type="text/css" href="../../bower_components/google-code-prettify/bin/prettify.min.css">
  <link rel="stylesheet" type="text/css" href="../../bower_components/docbase/styles/main.css">
  <link rel="stylesheet" type="text/css" href="../../bower_components/components-font-awesome/css/font-awesome.min.css">
  

  <!-- Custom -->
  <link rel="stylesheet" type="text/css" href="../../styles/docs.css">

</head>
<body role="flatdoc" class="no-literate">
  <!--[if lt IE 10]>
     <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
  <![endif]-->

  <!-- ngView:  --><div ng-view="" class="ng-scope"><!-- ngInclude: 'html/navbar.html' --><nav class="navbar navbar-default navbar-fixed-top ng-scope" ng-include="'html/navbar.html'"><div class="container-fluid ng-scope">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a id="docs-appbase-logo" class="navbar-brand" href="http://docs.appbase.io">
      <img src="../../images/logo.svg">
    </a>
  </div>

  <div class="collapse navbar-collapse" id="navbar-collapse">
    <ul class="nav navbar-nav">
      <!-- ngRepeat: folder in map[currentVersion] --><li class="dropdown ng-scope" ng-repeat="folder in map[currentVersion]">
        <a ng-href="#/scalr/concepts" class="dropdown-toggle ng-binding" data-toggle="dropdown" role="button" aria-expanded="false" ng-bind="folder.label" href="#/scalr/concepts">Concepts</a>
        <ul class="dropdown-menu">
          <!-- ngRepeat: file in folder.files --><li ng-repeat="file in folder.files" class="ng-scope">
            <a ng-href=../../scalr/concepts/intro.html ng-bind="file.label" class="ng-binding" href=../../scalr/concepts/intro.html>Intro</a>
          </li><!-- end ngRepeat: file in folder.files -->
        </ul>
      </li><!-- end ngRepeat: folder in map[currentVersion] --><li class="dropdown ng-scope" ng-repeat="folder in map[currentVersion]">
        <a ng-href="#/scalr/javascript" class="dropdown-toggle ng-binding" data-toggle="dropdown" role="button" aria-expanded="false" ng-bind="folder.label" href="#/scalr/javascript">Javascript</a>
        <ul class="dropdown-menu">
          <!-- ngRepeat: file in folder.files --><li ng-repeat="file in folder.files" class="ng-scope">
            <a ng-href=../../scalr/javascript/javascript-intro.html ng-bind="file.label" class="ng-binding" href=../../scalr/javascript/javascript-intro.html>Javascript Quick Start</a>
          </li><!-- end ngRepeat: file in folder.files --><li ng-repeat="file in folder.files" class="ng-scope">
            <a ng-href=../../scalr/javascript/nodejs-intro.html ng-bind="file.label" class="ng-binding" href=../../scalr/javascript/nodejs-intro.html>Node.JS Quick Start</a>
          </li><!-- end ngRepeat: file in folder.files -->
        </ul>
      </li><!-- end ngRepeat: folder in map[currentVersion] --><li class="dropdown ng-scope" ng-repeat="folder in map[currentVersion]">
        <a ng-href="#/scalr/rest" class="dropdown-toggle ng-binding" data-toggle="dropdown" role="button" aria-expanded="false" ng-bind="folder.label" href="#/scalr/rest">REST</a>
        <ul class="dropdown-menu">
          <!-- ngRepeat: file in folder.files --><li ng-repeat="file in folder.files" class="ng-scope">
            <a ng-href=../../scalr/rest/intro.html ng-bind="file.label" class="ng-binding" href=../../scalr/rest/intro.html>Quick Start</a>
          </li><!-- end ngRepeat: file in folder.files -->
        </ul>
      </li><!-- end ngRepeat: folder in map[currentVersion] -->
    </ul>

    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
           <span ng-bind="currentVersion" class="ng-binding">scalr</span> <span class="caret"></span>
        </a>
        <ul class="dropdown-menu version-switcher" role="menu">
          <!-- ngRepeat: version in versions --><li ng-repeat="version in versions" class="ng-scope">
            <a ng-href=../../scalr/concepts/intro.html ng-bind="version" class="ng-binding" href=../../scalr/concepts/intro.html>scalr</a>
          </li><!-- end ngRepeat: version in versions --><li ng-repeat="version in versions" class="ng-scope">
            <a ng-href=../../v2.0/concepts/datamodel.html ng-bind="version" class="ng-binding" href=../../v2.0/concepts/datamodel.html>v2.0</a>
          </li><!-- end ngRepeat: version in versions --><li ng-repeat="version in versions" class="ng-scope">
            <a ng-href=../../v3.0/changelog/changelog.html ng-bind="version" class="ng-binding" href=../../v3.0/changelog/changelog.html>v3.0</a>
          </li><!-- end ngRepeat: version in versions -->
        </ul>
      </li>
      <li class="github-star">
        <iframe src="https://ghbtns.com/github-btn.html?user=appbaseio&amp;repo=Docs&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
      </li>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</nav>
<div role="flatdoc" class="content-root ng-scope">
  <div class="menubar fixed">
    <div class="menu section" role="flatdoc-menu"><ul><li id="root-item" class="level-0"><ul class="level-1" id="root-list"><li id="quick-start-to-the-nodejs-api-item" class="level-1"><a id="quick-start-to-the-nodejs-api-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api" class="level-1" pref="#quick-start-to-the-nodejs-api">Quick Start to the  Node.JS API</a><ul class="level-2" id="quick-start-to-the-nodejs-api-list"><li id="quick-start-to-the-nodejs-api-step-0-creating-an-app-item" class="level-2"><a id="quick-start-to-the-nodejs-api-step-0-creating-an-app-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api-step-0-creating-an-app" class="level-2" pref="#quick-start-to-the-nodejs-api-step-0-creating-an-app">Step 0: Creating an App</a></li><li id="quick-start-to-the-nodejs-api-step-1-lib-setup-item" class="level-2"><a id="quick-start-to-the-nodejs-api-step-1-lib-setup-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api-step-1-lib-setup" class="level-2" pref="#quick-start-to-the-nodejs-api-step-1-lib-setup">Step 1: Lib Setup</a><ul class="level-3" id="quick-start-to-the-nodejs-api-step-1-lib-setup-list"><li id="quick-start-to-the-nodejs-api-step-1-lib-setup-1a-lib-test-item" class="level-3"><a id="quick-start-to-the-nodejs-api-step-1-lib-setup-1a-lib-test-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api-step-1-lib-setup-1a-lib-test" class="level-3" pref="#quick-start-to-the-nodejs-api-step-1-lib-setup-1a-lib-test">1.a: Lib Test</a></li></ul></li><li id="quick-start-to-the-nodejs-api-step-2-storing-data-item" class="level-2"><a id="quick-start-to-the-nodejs-api-step-2-storing-data-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api-step-2-storing-data" class="level-2" pref="#quick-start-to-the-nodejs-api-step-2-storing-data">Step 2: Storing Data</a></li><li id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-item" class="level-2"><a id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data" class="level-2" pref="#quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data">Step 3: GETing err, Streaming Data</a><ul class="level-3" id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-list"><li id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3a-modify-the-document-item" class="level-3"><a id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3a-modify-the-document-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3a-modify-the-document" class="level-3" pref="#quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3a-modify-the-document">3.a: Modify the Document</a></li><li id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3b-observe-the-streams-item" class="level-3"><a id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3b-observe-the-streams-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3b-observe-the-streams" class="level-3" pref="#quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3b-observe-the-streams">3.b: Observe the Streams</a></li></ul></li><li id="quick-start-to-the-nodejs-api-step-4-streaming-search-item" class="level-2"><a id="quick-start-to-the-nodejs-api-step-4-streaming-search-link" href="../../scalr/javascript/nodejs-intro.html#quick-start-to-the-nodejs-api-step-4-streaming-search" class="level-2" pref="#quick-start-to-the-nodejs-api-step-4-streaming-search">Step 4: Streaming Search</a></li></ul></li></ul></li></ul></div>
  </div>
  <div role="flatdoc-content" class="content"><h1 id="quick-start-to-the-nodejs-api">Quick Start to the <img src="http://i.imgur.com/Eppz2lz.png?1" alt="Scalr"> Node.JS API</h1><p><a href="https://github.com/appbaseio/appbase-js">Appbase.JS</a> is a minimalistic library for data streams.  </p><p>It can:</p><ul>
<li>Continuously stream documents, apply filters and query results over <code>http-streams</code>.</li>
</ul><p>It can’t:  </p><ul>
<li>Index documents, configure mappings, change analyzers. All these are provided by <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/index.html">elasticsearch.js</a> - the official ElasticSearch JS client library, which we will be using in this guide. </li>
</ul><p>This is a quick start guide to whet the appetite with the possibilities of data streams.</p><h2 id="quick-start-to-the-nodejs-api-step-0-creating-an-app">Step 0: Creating an App</h2><p><a href="https://imgflip.com/gif/opgl9"><img src="https://i.imgflip.com/opgl9.gif"></a><br>Log in to <span class="fa fa-external-link"></span> <a href="http://appbase.io/scalr/">Appbase Dashboard</a>, and create a new app.</p><p>For this tutorial, we will use an app called “createnewtestapp01”. The &lt;username&gt;:&lt;password&gt; combination for this app is RIvfxo1u1:dee8ee52-8b75-4b5b-be4f-9df3c364f59f.</p><blockquote>
<p>SCALR uses <em>HTTP Basic Auth</em>, a widely used protocol for simple username/password authentication.</p>
</blockquote><h2 id="quick-start-to-the-nodejs-api-step-1-lib-setup">Step 1: Lib Setup</h2><ol>
<li><p>Setting up <a href="https://www.npmjs.com/package/appbase-js">appbase-js</a> is easy.</p>
<pre><code class="prettyprint prettyprinted" style=""><span class="pln">npm install appbase</span><span class="pun">-</span><span class="pln">js</span></code></pre>
</li>
<li><p>For this tutorial, we will use <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/index.html">elasticsearch.js</a> - the official ElasticSearch client for indexing data.</p>
<pre><code class="lang-js prettyprint prettyprinted" style=""><span class="pln">npm install elasticsearch</span></code></pre>
</li>
<li><p>Code setup:</p>
<pre><code class="lang-js prettyprint prettyprinted" style=""><span class="comment"><span class="com">// app and authentication configurations  </span></span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> HOSTNAME </span><span class="pun">=</span><span class="pln"> </span><span class="string"><span class="str">"scalr.api.appbase.io"</span></span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> APPNAME </span><span class="pun">=</span><span class="pln"> </span><span class="string"><span class="str">"createnewtestapp</span><span class="number"><span class="str">01</span></span><span class="str">"</span></span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> USERNAME </span><span class="pun">=</span><span class="pln"> </span><span class="string"><span class="str">"RIvfxo</span><span class="number"><span class="str">1</span></span><span class="str">u</span><span class="number"><span class="str">1</span></span><span class="str">"</span></span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> PASSWORD </span><span class="pun">=</span><span class="pln"> </span><span class="string"><span class="str">"dee</span><span class="number"><span class="str">8</span></span><span class="str">ee</span><span class="number"><span class="str">52</span></span><span class="str">-</span><span class="number"><span class="str">8</span></span><span class="str">b</span><span class="number"><span class="str">75</span></span><span class="str">-</span><span class="number"><span class="str">4</span></span><span class="str">b</span><span class="number"><span class="str">5</span></span><span class="str">b-be</span><span class="number"><span class="str">4</span></span><span class="str">f-</span><span class="number"><span class="str">9</span></span><span class="str">df</span><span class="number"><span class="str">3</span></span><span class="str">c</span><span class="number"><span class="str">364</span></span><span class="str">f</span><span class="number"><span class="str">59</span></span><span class="str">f"</span></span><span class="pln">

</span><span class="comment"><span class="com">// load </span><span class="string"><span class="com">'appbase'</span></span><span class="com"> and </span><span class="string"><span class="com">'elasticsearch'</span></span><span class="com"> modules</span></span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> appbase </span><span class="pun">=</span><span class="pln"> require</span><span class="pun">(</span><span class="string"><span class="str">"appbase-js"</span></span><span class="pun">)</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> elasticsearch </span><span class="pun">=</span><span class="pln"> require</span><span class="pun">(</span><span class="string"><span class="str">'elasticsearch'</span></span><span class="pun">)</span><span class="pln">

</span><span class="comment"><span class="com">// elasticsearch client. we use it for indexing, mappings, search settings, etc.</span></span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> client </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> elasticsearch</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">({</span><span class="pln">
 host</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'https:</span><span class="comment"><span class="str">//'</span></span><span class="pun">+</span><span class="pln">USERNAME</span><span class="pun">+</span><span class="string"><span class="str">":"</span></span><span class="pun">+</span><span class="pln">PASSWORD</span><span class="pun">+</span><span class="string"><span class="str">"@"</span></span><span class="pun">+</span><span class="pln">HOSTNAME</span><span class="pun">,</span></span><span class="pln">
</span><span class="pun">});</span><span class="pln">

</span><span class="comment"><span class="com">// we will instantiate </span><span class="string"><span class="com">'appbase'</span></span><span class="com"> client when we need streams.</span></span></code></pre>
</li>
</ol><p><code>HOSTNAME</code> for SCALR API always points to “scalr.api.appbase.io”. Values of <code>APPNAME</code>, <code>USERNAME</code> and <code>PASSWORD</code> are taken from Step 0.</p><blockquote>
<p><span class="fa fa-info-circle"></span> Setting <code>USERNAME</code> and <code>PASSWORD</code> are necessary, as SCALR API only allows authenticated requests.</p>
</blockquote><h3 id="quick-start-to-the-nodejs-api-step-1-lib-setup-1a-lib-test">1.a: Lib Test</h3><p>We send a HEAD request to <a href="https://scalr.api.appbase.io/?hello=appbase">https://scalr.api.appbase.io/?hello=appbase</a> and allow up to 10 seconds for it to complete.</p><pre><code class="lang-js prettyprint prettyprinted" style=""><span class="pln">client</span><span class="pun">.</span><span class="pln">ping</span><span class="pun">({</span><span class="pln">
  requestTimeout</span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">10000</span></span><span class="pun">,</span><span class="pln">
  hello</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"appbase"</span></span><span class="pln"> </span><span class="comment"><span class="com">// appended as query string</span></span><span class="pln">
</span><span class="pun">}).</span><span class="pln">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">body</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="string"><span class="str">'All is well'</span></span><span class="pun">);</span><span class="pln">
  </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">error</span><span class="pun">(</span><span class="string"><span class="str">'elasticsearch cluster is down!'</span></span><span class="pun">,</span><span class="pln"> error</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">);</span></code></pre><p>If we are doing things correctly, we should see the console beeping “All is well”.</p><h2 id="quick-start-to-the-nodejs-api-step-2-storing-data">Step 2: Storing Data</h2><p>Let’s insert a JSON object. We create a <strong>type</strong> <code>books</code> inside our app and add a JSON document <code>1</code> with a <code>.index</code> request.</p><pre><code class="lang-js prettyprint prettyprinted" style=""><span class="kwd">var</span><span class="pln"> jsonObject </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="string"><span class="str">"department_name"</span></span><span class="pun">:</span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"department_name_analyzed"</span></span><span class="pun">:</span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"department_id"</span></span><span class="pun">:</span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"name"</span></span><span class="pun">:</span><span class="string"><span class="str">"A Fake Book on Network Routing"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"price"</span></span><span class="pun">:</span><span class="number"><span class="lit">5595</span></span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
client</span><span class="pun">.</span><span class="pln">index</span><span class="pun">({</span><span class="pln">
  index</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'createnewtestapp</span><span class="number"><span class="str">01</span></span><span class="str">'</span></span><span class="pun">,</span><span class="pln">
  type</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'books'</span></span><span class="pun">,</span><span class="pln">
  id</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'</span><span class="number"><span class="str">1</span></span><span class="str">'</span></span><span class="pun">,</span><span class="pln">
  body</span><span class="pun">:</span><span class="pln"> jsonObject
</span><span class="pun">}).</span><span class="pln">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">response</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">response</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">);</span></code></pre><p>where <code>index: 'createnewtestapp01'</code> uses the appname we created in Step 0. </p><blockquote>
<p><span class="fa fa-external-link-square"></span> Check out the <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html">ES API reference</a> for more client methods.</p>
<p><span class="fa fa-info-circle"></span> If you have noticed, SCALR uses the same APIs as <a href="https://www.elastic.co/products/elasticsearch">ElasticSearch</a>. A <strong>type</strong> is equivalent to a <em>collection in MongoDB</em> or a <em>table in SQL</em>, and a document is similar to the document in MongoDB and equivalent to a <em>row in SQL</em>.</p>
</blockquote><h2 id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data">Step 3: <s>GETing</s> err, Streaming Data</h2><p>Getting live updates to a document using the <code>streamDocument</code> method. It’s so awesome that we recommend using this as the default way instead of the <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-get"><code>client.get()</code></a> method supported by elasticsearch.js.</p><pre><code class="lang-js prettyprint prettyprinted" style=""><span class="comment"><span class="com">// we instantiate appbase client here. We use it for streaming data updates.</span></span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> streamingClient </span><span class="pun">=</span><span class="pln"> appbase</span><span class="pun">.</span><span class="pln">newClient</span><span class="pun">({</span><span class="pln">
    url</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'https:</span><span class="comment"><span class="str">//'</span></span><span class="pun">+</span><span class="pln">HOSTNAME</span><span class="pun">,</span></span><span class="pln">
    appname</span><span class="pun">:</span><span class="pln"> APPNAME</span><span class="pun">,</span><span class="pln">
    username</span><span class="pun">:</span><span class="pln"> USERNAME</span><span class="pun">,</span><span class="pln">
    password</span><span class="pun">:</span><span class="pln"> PASSWORD
</span><span class="pun">});</span><span class="pln">

streamingClient</span><span class="pun">.</span><span class="pln">streamDocument</span><span class="pun">({</span><span class="pln">
      type</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'books'</span></span><span class="pun">,</span><span class="pln">
      id</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'</span><span class="number"><span class="str">1</span></span><span class="str">'</span></span><span class="pln">
</span><span class="pun">}).</span><span class="pln">on</span><span class="pun">(</span><span class="string"><span class="str">'data'</span></span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="comment"><span class="com">// client would emit </span><span class="string"><span class="com">"data"</span></span><span class="com"> event every time there is a document update.</span></span><span class="pln">
      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}).</span><span class="pln">on</span><span class="pun">(</span><span class="string"><span class="str">'error'</span></span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">err</span><span class="pun">)</span><span class="pln">
</span><span class="pun">})</span><span class="pln">


INITIAL RESPONSE
</span><span class="pun">{</span><span class="pln">
  </span><span class="string"><span class="str">"_index"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"app`</span><span class="number"><span class="str">248</span></span><span class="str">"</span></span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"_type"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"books"</span></span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"_id"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"</span><span class="number"><span class="str">1</span></span><span class="str">"</span></span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"_version"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">5</span></span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"found"</span></span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"_source"</span></span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="string"><span class="str">"department_name"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"department_name_analyzed"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"department_id"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"name"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"A Fake Book on Network Routing"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"price"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">5595</span></span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Now everytime there is a document update, <code>streamingClient.streamDocument(...)</code> will emit the “data” event and we will print the parsed JSON on the console.</p><h3 id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3a-modify-the-document">3.a: Modify the Document</h3><p>Let’s modify the book price to 6034.</p><pre><code class="lang-js prettyprint prettyprinted" style=""><span class="kwd">var</span><span class="pln"> jsonObject </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="string"><span class="str">"department_name"</span></span><span class="pun">:</span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"department_name_analyzed"</span></span><span class="pun">:</span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"department_id"</span></span><span class="pun">:</span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"name"</span></span><span class="pun">:</span><span class="string"><span class="str">"A Fake Book on Network Routing"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"price"</span></span><span class="pun">:</span><span class="number"><span class="lit">6034</span></span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
client</span><span class="pun">.</span><span class="pln">index</span><span class="pun">({</span><span class="pln">
  index</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'createnewtestapp</span><span class="number"><span class="str">01</span></span><span class="str">'</span></span><span class="pun">,</span><span class="pln">
  type</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'books'</span></span><span class="pun">,</span><span class="pln">
  id</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'</span><span class="number"><span class="str">1</span></span><span class="str">'</span></span><span class="pun">,</span><span class="pln">
  body</span><span class="pun">:</span><span class="pln"> jsonObject
</span><span class="pun">}).</span><span class="pln">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">response</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">response</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">);</span></code></pre><h3 id="quick-start-to-the-nodejs-api-step-3-geting-err-streaming-data-3b-observe-the-streams">3.b: Observe the Streams</h3><pre><code class="lang-js prettyprint prettyprinted" style=""><span class="pln">RESPONSE AFTER </span><span class="number"><span class="lit">3</span></span><span class="lit">.a</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
  </span><span class="string"><span class="str">"_type"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"books"</span></span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"_id"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"</span><span class="number"><span class="str">1</span></span><span class="str">"</span></span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"_source"</span></span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="string"><span class="str">"department_id"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"department_name"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"department_name_analyzed"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"name"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"A Fake Book on Network Routing"</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"price"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">6034</span></span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>In the new document update, we can see the price change (5595 -&gt; 6034) being reflected. Subsequent changes will be streamed as JSON objects.</p><h2 id="quick-start-to-the-nodejs-api-step-4-streaming-search">Step 4: Streaming Search</h2><p>Streaming document updates seems straightforward, can we apply rich filters and queries to our streams? Yes, we can. We can specify any ElasticSearch Query DSL request, and get responses via streams using the <code>streamSearch</code> method.</p><p>We will see it here with a <code>match_all</code> query request.</p><pre><code class="lang-js prettyprint prettyprinted" style=""><span class="pln">streamingClient</span><span class="pun">.</span><span class="pln">streamSearch</span><span class="pun">({</span><span class="pln">
    type</span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">'books'</span></span><span class="pun">,</span><span class="pln">
    body</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        query</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            match_all</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}).</span><span class="pln">on</span><span class="pun">(</span><span class="string"><span class="str">'data'</span></span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln"> err</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">res</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}).</span><span class="pln">on</span><span class="pun">(</span><span class="string"><span class="str">'error'</span></span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="string"><span class="str">"caught a stream error"</span></span><span class="pun">,</span><span class="pln"> err</span><span class="pun">)</span><span class="pln">
</span><span class="pun">})</span><span class="pln">

INITIAL RESPONSE
</span><span class="pun">{</span><span class="pln">
  </span><span class="string"><span class="str">"took"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"timed_out"</span></span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
  </span><span class="string"><span class="str">"_shards"</span></span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="string"><span class="str">"total"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"successful"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"failed"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">0</span></span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="string"><span class="str">"hits"</span></span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="string"><span class="str">"total"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"max_score"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
    </span><span class="string"><span class="str">"hits"</span></span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
      </span><span class="pun">{</span><span class="pln">
        </span><span class="string"><span class="str">"_index"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"app`</span><span class="number"><span class="str">248</span></span><span class="str">"</span></span><span class="pun">,</span><span class="pln">
        </span><span class="string"><span class="str">"_type"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"books"</span></span><span class="pun">,</span><span class="pln">
        </span><span class="string"><span class="str">"_id"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"</span><span class="number"><span class="str">1</span></span><span class="str">"</span></span><span class="pun">,</span><span class="pln">
        </span><span class="string"><span class="str">"_score"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
        </span><span class="string"><span class="str">"_source"</span></span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          </span><span class="string"><span class="str">"price"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">6034</span></span><span class="pun">,</span><span class="pln">
          </span><span class="string"><span class="str">"department_name"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
          </span><span class="string"><span class="str">"department_name_analyzed"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"Books"</span></span><span class="pun">,</span><span class="pln">
          </span><span class="string"><span class="str">"department_id"</span></span><span class="pun">:</span><span class="pln"> </span><span class="number"><span class="lit">1</span></span><span class="pun">,</span><span class="pln">
          </span><span class="string"><span class="str">"name"</span></span><span class="pun">:</span><span class="pln"> </span><span class="string"><span class="str">"A Fake Book on Network Routing"</span></span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">]</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
  <a class="edit" ng-href="https://github.com/appbaseio/Docs/tree/master/src/scalr/javascript/nodejs-intro.md" target="_blank" href="https://github.com/appbaseio/Docs/tree/master/src/scalr/javascript/nodejs-intro.md">
    <span class="fa fa-pencil"> Edit</span>
  </a>
</div></div>
  <script type="text/javascript" src="../../scripts/analytics.js"></script>
  <script type="text/javascript" src="../../scripts/main.js"></script>
  <script type="text/javascript" src="../../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

</body></html>